<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Real Time Messaging</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.5.1/sockjs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
</head>
<body>
<div id="messageArea" class="message-area">
    <!-- ì˜ˆì‹œ: ì„œë²„ë¡œë¶€í„° ì´ˆê¸° ë©”ì‹œì§€ ëª©ë¡ì„ ë Œë”ë§ -->
    <ul>
        <li th:each="message : ${messages}" th:text="${message}">Sample Message</li>
    </ul>
</div>
<div class="input-area">
    <input type="textarea" id="messageInput">

</div>
<script th:inline="javascript">
    /* ê¸°ì¡´ JavaScript ì½”ë“œ ìœ ì§€ */
  const socket = new SockJS('/websocket');
  const stompClient = Stomp.over(socket);
  let timeout = null; // letìœ¼ë¡œ ì„ ì–¸í•´ì•¼ ìˆ˜ì • ê°€ëŠ¥

  stompClient.connect({}, function (frame) {
      stompClient.subscribe('/topic/public', function (messageOutput) {
          const messageArea = document.getElementById('messageArea');
          const messageElement = document.createElement('div');
          messageElement.classList.add('message-text'); // CSS í´ë˜ìŠ¤ ì ìš©

          // ì´ëª¨ì§€ ëª©ë¡
          const emojis = ['ğŸ±', 'ğŸ¶', 'ğŸ°', 'ğŸ¦Š', 'ğŸ»', 'ğŸ¼', 'ğŸ¨', 'ğŸ¯', 'ğŸ¸', 'ğŸµ'];
          // ëœë¤ ì´ëª¨ì§€ ì„ íƒ
          const randomEmoji = emojis[Math.floor(Math.random() * emojis.length)];

          // ë©”ì‹œì§€ ì•ì— ëœë¤ ì´ëª¨ì§€ ì¶”ê°€
          messageElement.innerHTML = `${randomEmoji} ${messageOutput.body}`;
          messageArea.appendChild(messageElement); // ë©”ì‹œì§€ ì˜ì—­ì— ì¶”ê°€
      });
  });

  function sendMessage() {
      var messageInput = document.getElementById('messageInput');
      stompClient.send("/app/send", {}, messageInput.value);
      messageInput.value = ''; // ë©”ì‹œì§€ ì „ì†¡ í›„ ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
  }

  function debounce(func, wait) {
      return function() {
          clearTimeout(timeout);
          timeout = setTimeout(func, wait);
      }
  }

  const debouncedSend = debounce(sendMessage, 1000);
  document.getElementById('messageInput').addEventListener('input', debouncedSend);

</script>

</body>
</html>



